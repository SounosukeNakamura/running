# 🏃 ランニングコース提案アプリ

## 概要

現在地から出発して、指定した時間以内に確実に出発地点へ戻ってこられるランニングコースを自動生成するアプリです。AIが走行距離や道路ネットワークを考慮して、最適な往復ルートを提案します。

**主な特徴：**
- 📍 現在地を自動取得
- ⏱️ 走りたい時間を入力するだけで距離を計算
- 🗺️ 実際の道路ネットワークに基づいたルート生成
- 🌤️ リアルタイム天気情報とランニングアドバイス
- 📱 レスポンシブデザイン対応

---

## 機能一覧

### 1. **現在地取得**
- ブラウザの Geolocation API を使用
- 位置情報の許可が必要です

### 2. **ランニングコース自動生成**
- 走りたい時間（分）を入力
- 指定時間内に必ず戻ってこられる距離を計算
- 実際の道路ネットワークに沿ったルート生成（OSRM 使用）
- 折り返し地点を自動設定

### 3. **地図表示**
- Geolonia を使用した高品質な地図
- 生成されたルートをリアルタイムで表示
- スタート＝ゴール地点とルートを視覚化

### 4. **天気情報表示**
- OpenWeather API によるリアルタイム天気取得
- 気温、体感温度、湿度、風速、降水量を表示
- 天気に応じた詳細なランニングアドバイス
  - 🔥 高温時：熱中症注意、水分補給の推奨
  - ❄️ 低温時：防寒対策、ウォームアップ推奨
  - 💧 高湿度時：ペース控えめの推奨
  - 🌪️ 強風時：転倒リスク注意
  - ☔ 降水時：路面注意、防水対策推奨

### 5. **住所表示**
- 逆ジオコーディング（Nominatim）で位置情報を住所に変換
- 日本の住所形式で見やすく表示
  - 例：「東京都　葛飾区　白鳥　2丁目」

---

## 使用技術

| 項目 | 技術 | 用途 |
|------|------|------|
| **フレームワーク** | React 18 + TypeScript 5 | UI フレームワーク |
| **ビルドツール** | Vite 5 | 高速ビルド・開発サーバー |
| **地図** | Geolonia | 地図表示・統合 |
| **ルーティング** | OSRM（Open Source Routing Machine） | 実際の道路ネットワークに基づくルート計算 |
| **天気** | OpenWeather API | リアルタイム天気情報 |
| **住所検索** | Nominatim | 逆ジオコーディング |
| **デプロイ** | Vercel | 本番環境ホスティング |

---

## セットアップ手順

### 前提条件
- Node.js 16 以上
- npm または yarn

### インストール

```bash
# リポジトリをクローン
git clone https://github.com/SounosukeNakamura/running.git
cd running

# 依存パッケージをインストール
npm install
```

### 環境変数の設定

プロジェクトルートに `.env.local` ファイルを作成し、以下の内容を追加してください：

```env
# OpenWeather API キー
# https://openweathermap.org/api で取得
VITE_OPENWEATHER_API_KEY=your_api_key_here

# ランニングペース（分/km）
VITE_RUNNING_PACE_MIN_PER_KM=5
```

**注意：APIキーは絶対に public リポジトリに commit しないでください。`.gitignore` で `.env.local` を無視しています。**

### 開発サーバーの起動

```bash
npm run dev
```

ブラウザで `http://localhost:5173` を開き、アプリを実行します。

### 本番ビルド

```bash
npm run build
```

### ビルド結果の確認

```bash
npm run preview
```

---

## 使い方

1. **ブラウザを開く**
   - デプロイされたアプリ：https://running-ashen-one.vercel.app
   - または、ローカル開発サーバー

2. **位置情報を許可**
   - ブラウザから位置情報の許可を求められます
   - 「許可」をクリック

3. **走りたい時間を入力**
   - 「走りたい時間（分）」に数字を入力（例：30分）
   - 1～300分の範囲内で指定可能

4. **「コースを生成」をクリック**
   - ルートが自動生成され、地図に表示されます
   - 走行距離と推定時間を確認できます

5. **天気情報を確認**
   - リアルタイム天気とランニングアドバイスが表示されます
   - アドバイスに従って、安全にランニングを楽しんでください

---

## 注意事項

⚠️ **重要な注意事項**

- **位置情報について**
  - アプリは位置情報の利用許可が必要です
  - 位置情報は計算用に使用され、保存や送信はされません
  
- **APIキー管理**
  - OpenWeather API キーを公開しないでください
  - Vercel にデプロイする場合、環境変数を設定してください
  
- **ルートの精度**
  - 生成されたルートはあくまで参考値です
  - 実際のランニング前に地図で確認してください
  - 天候や道路状況によってコースを調整してください

- **位置情報精度**
  - GPS の精度は環境によって異なります
  - 屋内や林の中では精度が低下する可能性があります

---

## トラブルシューティング

### 位置情報が取得できない
- ブラウザの位置情報許可を確認してください
- プライベートブラウジングモードでは位置情報が制限される場合があります

### 天気情報が表示されない
- ブラウザのコンソール（F12）でエラーメッセージを確認してください
- OpenWeather API キーが正しく設定されているか確認してください
- Vercel にデプロイしている場合、環境変数が設定されているか確認してください

### ルートが生成されない
- 走行時間を 1～300分の範囲で入力してください
- ネットワーク接続を確認してください
- OSRM API が利用可能か確認してください

---

## ファイル構成

```
.
├── index.html              # HTML テンプレート
├── package.json            # 依存パッケージ定義
├── tsconfig.json           # TypeScript 設定
├── vite.config.ts          # Vite 設定
├── .env.example            # 環境変数例（テンプレート）
├── .env.local              # 環境変数（.gitignore で無視）
├── README.md               # このファイル
└── src/
    ├── main.tsx            # エントリーポイント
    ├── App.tsx             # メインアプリケーションコンポーネント
    ├── App.css             # スタイルシート
    ├── utils.ts            # ユーティリティ関数（API呼び出し、型定義）
    └── routeOptimizer.v2.ts # ルート最適化エンジン
```

---

## 環境情報

| 項目 | バージョン |
|------|-----------|
| Node.js | 16+ |
| React | 18.2+ |
| TypeScript | 5+ |
| Vite | 5+ |

---

## ライセンス

MITライセンス

---

## サポート

問題が発生した場合は、GitHub Issues で報告してください。

---

**最終更新：2025年12月22日**
