<!doctype html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>å¤©æ°—Ã—ãƒ©ãƒ³ãƒ‹ãƒ³ã‚°ã‚³ãƒ¼ã‚¹ææ¡ˆã‚¢ãƒ—ãƒª</title>
    <style>
      [data-lat][data-lng] {
        width: 100%;
        height: 400px;
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    
    <!-- Geolonia Maps Embed API -->
    <script type="text/javascript" src="https://cdn.geolonia.com/v1/embed?geolonia-api-key=57e50c6fcf3240359f4cf08862c029d6"></script>
    
    <script>
      // Geolonia ã‚¹ã‚¯ãƒªãƒ—ãƒˆèª­ã¿è¾¼ã¿å¾Œã«ã‚°ãƒ­ãƒ¼ãƒãƒ«ãªåœ°å›³åˆæœŸåŒ–é–¢æ•°ã‚’ç™»éŒ²
      window.initializeGeoloniaMaps = function() {
        console.log('ğŸ—ºï¸ initializeGeoloniaMaps() called');
        
        if (!window.geolonia) {
          console.error('âŒ Geolonia not loaded');
          return;
        }
        
        // ã™ã¹ã¦ã®ãƒ‡ãƒ¼ã‚¿å±æ€§ã‚’æŒã¤è¦ç´ ã‚’å‡¦ç†
        const mapElements = document.querySelectorAll('[data-lat][data-lng]');
        console.log('Found ' + mapElements.length + ' map elements to initialize');
        
        mapElements.forEach(function(element, index) {
          const lat = parseFloat(element.getAttribute('data-lat'));
          const lng = parseFloat(element.getAttribute('data-lng'));
          const zoom = parseInt(element.getAttribute('data-zoom') || '14');
          
          console.log('Initializing map ' + (index + 1) + ': lat=' + lat + ', lng=' + lng + ', zoom=' + zoom);
          
          try {
            // Geolonia.Map ã‚¯ãƒ©ã‚¹ã‚’ä½¿ç”¨ã—ã¦æ˜ç¤ºçš„ã«åœ°å›³ã‚’ä½œæˆ
            const map = new window.geolonia.Map({
              container: element,
              style: 'https://cdn.geolonia.com/alls/v1/style.json',
              center: [lng, lat],
              zoom: zoom,
              pitch: 0,
              bearing: 0
            });
            
            map.on('load', function() {
              console.log('âœ“ Map ' + (index + 1) + ' loaded successfully');
            });
            
            map.on('error', function(error) {
              console.error('Map ' + (index + 1) + ' error:', error);
            });
          } catch (err) {
            console.error('Failed to initialize map ' + (index + 1) + ':', err);
          }
        });
      };
      
      // Geolonia èª­ã¿è¾¼ã¿å®Œäº†å¾Œã«åˆæœŸåŒ–
      window.addEventListener('load', function() {
        if (window.geolonia) {
          console.log('âœ“ Geolonia loaded on page load');
          // React ãŒãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã™ã‚‹ã¾ã§å°‘ã—å¾…ã¤
          setTimeout(function() {
            window.initializeGeoloniaMaps();
          }, 500);
        }
      });
    </script>
    
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
